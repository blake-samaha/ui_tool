# schema: https://schemas.cognite.ai/requirements/00_Solution_Design_Principles.schema.json
schemaVersion: 1
moduleId: my_module
projectId: "{{project_id}}"

space:
  externalId: sp_my_project_space
  description: My project data space

environments:
  - name: dev
    cdf_cluster: westeurope-1
    cdf_region: eu-west-1
    idp_tenant_id: 00000000-0000-0000-0000-000000000000
    admin_group_source_id: 00000000-0000-0000-0000-000000000001
    user_group_source_id: 00000000-0000-0000-0000-000000000002
    authentication:
      method: client_credentials
      authority: https://login.microsoftonline.com/{{ idp_tenant_id }}
      clientId: 11111111-1111-1111-1111-111111111111
      clientSecret: ${ENV:AZURE_CLIENT_SECRET}
      scopes: [https://cognitedata.com/.default]
  - name: prod
    cdf_cluster: westeurope-1
    cdf_region: eu-west-1
    idp_tenant_id: 00000000-0000-0000-0000-000000000000
    admin_group_source_id: 00000000-0000-0000-0000-000000000011
    user_group_source_id: 00000000-0000-0000-0000-000000000012
    authentication:
      method: device_code
      authority: https://login.microsoftonline.com/{{ idp_tenant_id }}
      clientId: 22222222-2222-2222-2222-222222222222
      scopes: [https://cognitedata.com/.default]

rawSources:
  - sourceSystem: SAP S/4HANA
    database: raw_sap_s4hana
    tables: [aufk, afih]
    description: Work orders and maintenance notifications

toolkit:
  deployStrategy: upsert
  dryRun: false
  retries:
    maxAttempts: 6
    backoff: exponential
    maxBackoffSeconds: 64

promotion:
  fromEnv: dev
  toEnv: prod
  guardrails: [diff_only, require_approval]

accessRoles:
  - name: Data Administrator
    sourceIdVariable: "{{ admin_group_source_id }}"
    permissionsSummary: Full control over all resources
    capabilities:
      - datamodels:read,write
      - transformations:read,write
      - timeseries:read,write
      - files:read,write
  - name: Application User
    sourceIdVariable: "{{ user_group_source_id }}"
    permissionsSummary: Read-only access to final processed data
    capabilities:
      - datamodels:read
      - transformations:read
      - timeseries:read
      - files:read

globalStandards:
  globalNamingConvention: prefix:scope:name
  timestampStandard: ISO 8601 UTC
  requiredPropertyForAllObjects: source_last_updated_time

coreModelInheritance:
  assetView:
    space: cdf_cdm
    externalId: CogniteAsset
    version: v1
  eventView:
    space: cdf_cdm
    externalId: CogniteEvent
    version: v1

externalModels:
  - space: cdf_cdm
    models: [CogniteAsset v1, CogniteEvent v1]

idMacros:
  moduleIdPrefix: true
  examples:
    - "{{ moduleId }}:dm:project_model:v1"
    - "{{ moduleId }}:view:work_order:v1"


